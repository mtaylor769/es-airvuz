<!DOCTYPE html>
<html view="app.views.view.template.login">
    <head>
        <meta http-equiv="Cache-control" content="public">
        <title>AirVuz</title>

        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        {> "app.views.view.partial.css" /}

    </head>
    <body>
        {> "app.views.view.partial.header" /}
        <div class="home">viewName[]: {login.viewName} </div>
        <div id="airvuz-app">
            <div class="container">

              <div class="jumbotron text-center">
                  <!-- convert to non-form and use ajax -->

                  <div class="form-signin">
                    <h2 class="form-signin-heading">Please sign in</h2>
                    <div>
                      <label for="login-email" class="sr-only">Email</label>
                      <input id="login-email" name="email" placeholder="Email" class="form-control" required>
                    </div>
                    <div>
                      <label for="login-password" class="sr-only">Password</label>
                      <input id="login-password" type="password" name="password" placeholder="Password" class="form-control" required>
                    </div>
                    <button onclick="login()" value="Login" class="btn btn-lg btn-info">Login</button>
                  </div>

                  <div class="form-signin">
                    <h2 class="form-signin-heading">Create User</h2>
                    <div>
                      <label for="create-email" class="sr-only">Email</label>
                      <input id="create-email" name="email" placeholder="Email" class="form-control" required>
                    </div>
                    <div>
                      <label for="create-username" class="sr-only">Username</label>
                      <input id="create-username" name="username" placeholder="Username" class="form-control" required>
                    </div>
                    <div>
                      <label for="create-password" class="sr-only">Password</label>
                      <input id="create-password" type="password" name="password" placeholder="Password" class="form-control" required>
                    </div>
                    <button onclick="createUser()" value="Submit" class="btn btn-lg btn-success">Submit</button>
                  </div>

                  <p>Login or Register with:</p>

                  <a href="/api/auth/facebook" class="btn btn-primary"><span class="fa fa-facebook"></span> Facebook</a>

                  <a href="/api/auth/google" class="btn btn-danger"><span class="fa fa-google-plus"></span> Google</a>

                  <a href="/api/auth/instagram" class="btn btn-info"><span class="fa fa-instagram"></span> Instagram</a>

              </div>

            </div>

        </div>
        {> "app.views.view.partial.footer" /}

        {> "app.views.view.partial.js" /}
        <script>
            // (function() {
            //   // if (newUser) {
            //     //test
            //   // }
                
            // })();
            function createUser() {
              password    = document.getElementById("create-password").value;
              email       = document.getElementById("create-email").value;
              username    = document.getElementById("create-username").value;

              var xhr = new XMLHttpRequest();
              xhr.open('POST', '/api/users/create', false);
              xhr.setRequestHeader('Content-Type', 'application/json');
              xhr.onload = function() {
                  if (xhr.status === 200) {
                      var userInfo = JSON.parse(xhr.responseText);
                  }
              };
              xhr.send(JSON.stringify({
                  email           : email,
                  username        : username,
                  password        : password
              }));

             }

            function login() {
              password    = document.getElementById("create-password").value;
              email       = document.getElementById("create-email").value;

              var xhr = new XMLHttpRequest();
              xhr.open('POST', '/api/auth', false);
              xhr.setRequestHeader('Content-Type', 'application/json');
              xhr.onload = function() {
                  if (xhr.status === 200) {
                      var userInfo = JSON.parse(xhr.responseText);
                  }
              };
              xhr.send(JSON.stringify({
                  emailAddress           : email,
                  password        : password
              }));
           }

           function facebookLogin() {

           }
        </script>
        
    </body>
    
</html>
